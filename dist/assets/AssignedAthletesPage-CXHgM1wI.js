import{j as e,m as o,U as h,c as C,x as _,M as I,h as L}from"./ui-D_jLh_Lr.js";import{r as c}from"./vendor-B9gohGc-.js";import{u as D,a as x,l as T}from"./index-D5lOMFz8.js";import"./supabase-DOoHAlwf.js";import"./router-CIHs1KQM.js";function R(){const{user:d}=D(),[y,p]=c.useState([]),[j,g]=c.useState(!0),[r,f]=c.useState(""),[n,b]=c.useState("all");c.useEffect(()=>{d&&v()},[d]);const v=async()=>{if(d)try{g(!0);const s=await x.getAssignments(d.id),a=[...new Set(s.map(i=>i.student_id))],t=await Promise.all(a.map(async i=>{const w=await x.getUsers().then(l=>l.find(m=>m.id===i)),A=s.filter(l=>l.student_id===i),S=(await x.getInjuries(i)).sort((l,m)=>new Date(m.date_reported).getTime()-new Date(l.date_reported).getTime())[0];return{...w,assignments:A,latestInjury:S}}));p(t)}catch(s){T.error("Error fetching assigned athletes:",s)}finally{g(!1)}},u=y.filter(s=>{const a=s.full_name.toLowerCase().includes(r.toLowerCase())||s.email.toLowerCase().includes(r.toLowerCase());return n==="active"?a&&s.assignments.some(t=>t.active):n==="completed"?a&&s.assignments.every(t=>!t.active):a}),N=s=>{switch(s){case"reported":return"bg-blue-100 text-blue-800";case"assigned":return"bg-purple-100 text-purple-800";case"in_treatment":return"bg-indigo-100 text-indigo-800";case"recovering":return"bg-green-100 text-green-800";case"resolved":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return j?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(h,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Assigned Athletes"}),e.jsx("p",{className:"text-gray-600",children:"Manage your assigned student-athletes and their recovery"})]})]}),e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(C,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),e.jsx("input",{type:"text",placeholder:"Search athletes...",value:r,onChange:s=>f(s.target.value),className:"pl-10 w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{className:"w-5 h-5 text-gray-400"}),e.jsxs("select",{value:n,onChange:s=>b(s.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Athletes"}),e.jsx("option",{value:"active",children:"Active Cases"}),e.jsx("option",{value:"completed",children:"Completed Cases"})]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:u.map((s,a)=>e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:a*.1},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-lg font-semibold text-gray-600",children:s.full_name.split(" ").map(t=>t[0]).join("")})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.full_name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.email})]})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:e.jsx(I,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:e.jsx(L,{className:"w-4 h-4"})})]})]}),s.latestInjury&&e.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Latest Injury"}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${N(s.latestInjury.status)}`,children:s.latestInjury.status.replace("_"," ")})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:s.latestInjury.injury_type}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.latestInjury.body_part," â€¢ ",new Date(s.latestInjury.date_occurred).toLocaleDateString()]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Active Assignments"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.assignments.filter(t=>t.active).length})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Total Cases"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.assignments.length})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"flex-1 bg-blue-600 text-white py-2 px-3 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:"View Details"}),e.jsx("button",{className:"flex-1 bg-gray-100 text-gray-700 py-2 px-3 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:"Message"})]})})]},s.id))}),u.length===0&&e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-12 bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx(h,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:r||n!=="all"?"No athletes found":"No assigned athletes"}),e.jsx("p",{className:"text-gray-600",children:r||n!=="all"?"Try adjusting your search or filter criteria.":"You don't have any assigned athletes yet. Contact an administrator to get assigned to cases."})]})]})}export{R as AssignedAthletesPage};
